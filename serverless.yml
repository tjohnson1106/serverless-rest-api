service: rest-api
provider:
  name: aws
  runtime: nodejs6.10
  stage: dev
  region: us-east-1
  environment: 
  DYNAMODB_TABLE :  'notes'
  iamRoleStatements :
    -  Effect:  Allow
       Action:
          - dynamodb: Query
          - dynamodb: Scan
          - dynamodb: GetItem
          - dynamodb: PutItem
          - dynamodb: UpdateItem
          - dynamodb: DeleteItem
       Resource: "arn: aws: dynamodb: ${opt: region, 
       self: provider.region}: *:table/$
       {self.provider.environment.DYNAMODB_TABLE}"



functions:
  hello:
    handler: handler.hello


resources:
    Resources:
        NotesDynamoDbTable:
            Type: 'AWS: :DynamoDB: :Table'
            DeletionPolicy: Retain
            Properties:
                AttributeDefinitions:
                    -
                       AttributeName: id
                       AttributeType: S
                KeySchema:
                    -
                        AttributeName: id
                        KeyType: HASH
                ProvisionedThroughput:
                    ReadCapacityUnits: 1
                    WriteCapacityUnits: 1
                TableName: ${self :provider.environment.DYNAMODB_TABLE}
                   

plugins: 
    - serverless-dynamodb-local
    - serverless-offline